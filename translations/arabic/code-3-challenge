<h1>تحدي البرمجة 3</h1>
<h1>البحث في قاعدة البيانات</h1>
<ul>
  <li><a href="#design">تصميم الشاشة</a></li>
  <li><a href="#data">إضافة بيانات لقاعدة البيانات</a></li>
  <li><a href="#list">إنشاء قوائم من الأسماء و القيم</a></li>
  <li><a href="#check1">نقطة الفحص 1</a></li>
  <li><a href="#search">برمجة زر البحث</a></li>
  <li><a href="#check2">نقطة الفحص 2</a></li>
  <li><a href="#newscreen">عرض نتائج البحث</a></li>
  <li><a href="#finalcheck">نقطة الفحص الأخيرة</a></li>
</ul>
<h3>الشرح</h3>
إنشاء تطبيق يُمكّن المستخدم من البحث في قاعدة بيانات و عرض نتائج البحث. قاعدة البيانات يجب أن تحتوي على الأسماء والوصف لأشخاص مشهورين، أماكن، أفلام، موسيقى، أحداث أو أي شيء آخر تريدينه. تأكدي من أن يكون لديكِ ثلاث مدخلات على الأقل في قاعدة البيانات خاصتك.

يمكنكِ إلقاء نظرة على التطبيق من هنا:  <a href="https://play.google.com/store/apps/details?id=appinventor.ai_alliec.DatabaseSearch">تحدي التيكنوفيشن 3</a>

حاولي أن تكتشفي كيفية اكمال هذا التحدي بنفسكِ قبل أن تنظري الى التعليمات. التعليمات تُظهر لكِ طريقة واحدة لحل هذا التحدي.

برمجة سعيدة!
<h3>نظرة عامة</h3>
لقد قررنا معالجة تحدي الكود هذا من خلال تخزين البيانات في TinyDB . لقد قمنا بتخزين أسماء العالمات ك tag names . بعد ذلك قمنا بعمل قائمتين، واحدة بأسماء الأشخاص، وواحدة تحتوي على وصف لأعمالهن. المستخدم يُدخل نص والتطبيق سيبحث عن توافق بكل عنصر في كلا القائمتين. اذا كان هناك توافق، اسم العالمة سيظهر في <strong>list view(قائمة اظهار)</strong>. المستخدم يستطيع أن يختار أي عالمة يريد أن يعرف عنها أكثر وشاشة جديدة سوف تفتح مع وصف لأعمالها. لهذا التطبيق، كان يجب أن نستخدم <strong>TinyDB </strong>لتخزين المعلومات وبذالك نستطيع استخدامها في شاشة منفصلة.
<table>
<tbody>
<tr>
<td style="text-align: right;"><b>الاسم(Tag)</b></td>
<td><b>الوصف</b></td>
</tr>
<tr>
<td style="text-align: right;">أدا لافليس</td>
<td>كانت أدا عالمة رياضيات انجليزية ، عاشت أدا في القرن السابع عشر وكانت مشهورة بعملها على الكمبيوتر الميكانيكي للاستخدام العام  المسمى بالمحرك التحليلي، وتعتبر أدا أول مبرمجة في التاريخ وذلك لانها قامت بكتابة أول خوارزيمة ليتم تنفيذها من خلال آلة.</td>
</tr>
<tr>
<td style="text-align: right;">ماري كوري</td>
<td>ماري هي فيزيائية وكيميائية ولدت في بولندا في مدينة ورسو في عام 1867، قامت بمساعدة زوجها باكتشاف عنصرين اشعاعين جديدن ، فازت ماري بجائزة نوبل للفيزياء عام 1903، وقد قامت أيضاً باكتشاف غاز الرايدوم والذي يمكن استخدامه في معالجة السرطان.</td>
</tr>
<tr>
<td style="text-align: right;">أليس بوول</td>
<td>كانت أليس كيميائية عاشت في مدينة سياتيل في عام 1892 ، لقد كانت أول شخص من أصول افريقية وأول امرأة تتخرج من جامعة هاواي ، في عمر 23 قامت أليس بتطوير علاج لمرض الجذام ، حيث كان يعتقد  أنه مرض غير قابل للعلاج.</td>
</tr>
<tr>
<td style="text-align: right;">سو لان</td>
<td style="direction: ltr;">سو لان هي مختصة في فيزياء الجسيمات ، ولدت في بدايات 1940 خلال الاحتلال اليباني لهونج كونج ، حصلت على شهادة الدوكتوراة من جامعة هارفرد، كانت  قائدة الفريق الذي قام باكتشاف غلون ، وهي واحدة من أشهر الفيزيائين في هذا المجال وقد قامت بالعديد من الاكتشافات الضخمة .</td>
</tr>
<tr>
<td style="text-align: right;">باتريكا باث</td>
<td style="direction: ltr;"> باتريكا هي اخصائية بصريات  ومخترعة ، ولدت باتريكا  في سنة 1942 في مدينة نيويورك في حي هارلم ، قامت بإنهاء المدرسة الثانوية في سنتين ونصف فقط ، كان طموحا أن تصبح طبيبة ، في عام 1985 قامت بإنهاء اختراع يقوم بإزالة ضبابية الرؤية وإعادة  الرؤية للناس في جميع أنحاء العالم.</td>
</tr>
</tbody>
</table>
<h3>تصميم الشاشة</h3>
نحن نريد للمستخدم أن يتمكن من البحث في قاعدة بيانات، وبالتالي سنقوم باضافة مربع كتابة للمستخدم لادخال النص الذي سوف يستخدم في البحث، وسنضيف زر بحث للضغط عليه من أجل الابتداء بعملية البحث. نحن نعلم أننا سنقوم بتخزين المعلومات في قاعدة بيانات، فإننا نقوم بجر <strong>TinyDB</strong> على الشاشة. ونحن نعلم أننا سنستخدم قوائم وبالتالي نضيف <strong>listview إ</strong>لى الشاشة.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image17-1024x553.png" alt="image17" width="1024" height="553" />
<h3>إضافة بيانات لقاعدة البيانات</h3>
لقد قررنا أن نضيف أسماء العالمات ك tag والوصف لأعمالهن ك value أو قيمة في قاعدة البيانات. لقد قمنا بنسخ ولصق المعلومات التي نريد اضافتها لقاعدة البيانات بهذا الشكل:

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image37-1024x580.png" alt="image37" width="497" height="282" />

يجب أن تخزني معلوماتكِ في قاعدة البيانات عندما يتم تهيئة شاشتك وبالتالي هذا أول شيء سيقوم به تطبيقك. سوف تحتاجي استخدام قاعدة بيانات لتخزين هذه المعلومات، اذا كنتي تخططي لاستخدامها في أي شاشة أخرى  في AppInventor الطريقة الوحيدة لنقل البيانات بين شاشات العرض هو عن طريق قاعدة البيانات أو باستخدام صندوق SartValue. سوف نرى  لاحقاً كيفية استخدام هاتين الطريقتين من <a href="http://appinventor.mit.edu/explore/ai2/concepts.html#Screens" target="_blank">هنا.</a>
<h3>إنشاء قوائم بأسماء الtag و قيم قاعدة البيانات</h3>
لقد أنشأنا قائمة لتخزين tag names فيها. بداية ننشىء قائمة فارغة اسمها "TagNames". ثانيا نضيف blocks لاضافة كل واحدة من tag names لهذه القائمة. يجب أن نتأكد من أن كل tag name نقوم باضافتها للقائمة تتوافق تماما مع ال tag name في قاعدة البيانات، بما فيها كل الحروف الكبيرة.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image58-1024x548.png" alt="image58" width="849" height="455" />

والآن نحن لدينا قائمة مليئة بtag names، نحن بحاجة لإنشاء قائمة أخرى تحتوي على كل القيم(values) في قاعدة البيانات بنفس ترتيب ال tag names. أولا نقوم بإنشاء قائمة فارغة لتخزين كل القيم من قاعدة البيانات تدعى " databaseValues ". ثانيا، نضيف كل قيمة للقائمة بنفس ترتيب الtag التي تتوافق معها من خلال استخدام الfor loop. لكل عنصر في قائمة ال"tagNames"، نضيف القيمة من قاعدة البيانات الى قائمة "databaseValues". ثم نضيف هذه الfor loop الى <strong>When Screen1.Initialize</strong> event handler.

<img src="http://technovationchallenge.org/wp-content/uploads/2016/11/DBvar.png" alt="" width="419" height="42" />

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image42-1024x314.png" alt="image42" width="600" height="184" />

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image50-1024x470.png" alt="image50" width="650" height="298" />
<h3>نقطة الفحص #1</h3>
عند هذه النقطة يجب أن يكون لديكِ كل البيانات في قاعدة البيانات بالاضافة لقائمة بكل الtag names وقائمة بقيم قاعدة البيانات خاصتك. تأكدي أنّ كل قائمة تحتوي على القيم التي تريدينها! بما أن تطبيقك لا يفعل شيئا حتى الآن، يمكنكِ أن تفحصي عملك من خلال عرض قوائمك في ال ListView خاصتك والتأكد أنّ كل شيء موجود. أضيفي هذا الblock لكودك بالأسفل الfor loop في ال<strong> when Screen1.Initialize</strong> event handler للتأكد من أن قائمتك “tagNames” دقيقة.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image00-1024x90.png" alt="image00" width="418" height="37" />

أضيفي هذا الblock لكودك بالأسفل الfor loop في ال <strong>when Screen1.Initialize</strong> event handler للتأكد من أن قائمتك “databaseVales” دقيقة.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image48-1024x78.png" alt="image48" width="456" height="35" />

بعد أن تأكدتي من دقة قوائمك، تأكدي من حذف هذه الblocks!
<h3>برمجة زر البحث</h3>
نحن نريد من مستخدمنا أنيكون قادر على البحث في قاعدة البيانات من خلال ادخال نص إلى مربع الكتابة والضغط على زر البحث "search". لفعل ذالك، نحن سنقوم بوضع معالج حدث (event handler) على زر البحث والذي سيقوم بالبحث بكل عنصر في كلا القائمتان ال " tagName" وال“databaseValues” على نص يتوافق مع النص الذي كتبه المستخدم. إذا كان هناك توافق، سنقوم بإضافة اسم العالمات لل view list. وهنا كيف قمنا بذالك.

أولا، أنشأنا متغير يدعى “searchResults” وعرّفناه ليكون قائمة فارغة.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image03-1-1024x88.png" alt="image03" width="439" height="38" />

ثانيا، أضفنا معالج الحدث لزر البحث. في داخله أضفنا block لجعل نتائج البحث لتكون قائمة فارغة. لأنه في كل مرة يضغط المستخدم “search” نريد أن نمسح أي عنصر كان قد تم اضافته الى “searchResults” في آخر بحث.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image02-1024x183.png" alt="image02" width="441" height="79" />

ثالثا، نعرّف ال <strong>for loop</strong> التي تبحث في كل عنصر في قائمة “tagName” وفي قائمة “databaseValue”. نحن لم نستخدم ال <strong>for each item</strong> في list loop لأننا أردنا أن نستخدم متغير العد (counting variable) في ال <strong>for loop</strong>. لقد بدأنا ال <strong>for loop</strong> ب 1 وأنهيناها عند عدد عناصر القائمة. غيرنا اسم المتغير الى index.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image54-1024x383.png" alt="image54" width="519" height="194" />

هنا الblock التي استخدمناها لمقارنة النص الذي بحث عنه المستخدم في مربع الكتابة مع عناصر القائمة في قائمة“tagNames”. المتغير “index” يزيد بمقدار واحد في كل مرة تتكرر فيها الloop اذا في النهاية سيتم فحص نص مربع الكتابة مع كل عنصر في قائمة“tagNames”. اخترنا كل شيء ليكون downcase أو أحرف صغيرة لمنع البحث في حالات(case sensitive). البلوك “contains text” ينتج true اذا ظهرت ال <i>piece </i>في النص.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image28-1024x172.png" alt="image28" width="508" height="85" />

لمقارنة بحث المستخدم ب“databaseValues” استخدمنا نفس البلوك باستثناء تغيير اسم القائمة.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image51-1024x161.png" alt="image51" width="585" height="92" />

<em>ملاحظة : المؤشر هو عبارة عن المتغير counter ، لذلك هو متغير محلي ولا يمكن استخدامه إلا داخل for loop  ، ولجعله يظهر في drop down menu من المتغيرات المتاحة ، سوف تحتاجين  إلى وضعك المكعب داخل for loop ، لا تقلقي أين تضعين المكعبات ، تستطيعين تغير أماكنهن لاحقاً.</em>

نريد أن نظهر للمستخدم أسماء ووصف العالمات التي تتوافق مع بحث المستخدم. لنفعل ذالك استخدم البلوكس الاثنان السابقان مع عامل <strong>OR </strong>الشرطي.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image05.png" alt="image05" width="215" height="93" />

هنا كيف يبدو الكود عند تعبأة عملية ال <strong>OR</strong>:
<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image10-1024x223.png" alt="image10" width="1024" height="223" />

نريد من الكود أن يضيف اسم العالمات للقائمة“searchResults” اذا كان اسمها أو الوصف الخاص بها يتوافق مع بحث المستخدم. لفعل ذالك عندما يكون هناك توافق نضيف الاسم من tagNames باستخدام متغير الloop المدعى“index”.. لم نضف <strong>else </strong>لجملتنا الشرطية لأنه اذا لم يكن هناك توافق في الاسم او الوصف لا نريد من الكود أن يفعل شيئا. ومن ثم نضيف العناصر من قائمة“searchResults” الى ال <strong>ListView</strong>. لأن هذا البلوك خارج ال for loop، الكود يقوم بتعديل ال <strong>ListView </strong>بعد أن تنتهي الfor loop.

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image39-1024x302.png" alt="image39" width="1024" height="302" />
<h3><b>نقطة فحص #2</b></h3>
حتى اللحظة لقد قمتي بكتابة الكثير من الكود! افحصي كودكِ جيدا للتأكد من قدرته على البحث. جربي البحث عن اسم مثل“Alice” أو جزء من وصف مثل“chemist”. ، تأكدي من الحصول على النتائج المتوقعة قبل المضي قدماً.
<h3>عرض نتائج البحث على شاشة جديدة</h3>
قررنا أن تطبيقنا سيكون أفضل اذا كان بإمكان المستخدم اختيارعالمة من العالمات اللواتي ظهرن في نتائج البحث ويرغب بالتعرف عليها أكثر. لفعل ذالك، عند اختيار المستخدم شيء من القائمة، سنفتح شاشة جديدة مع <strong>startValue </strong>لاختيار المستخدم تذكر الطريقة الوحيدة لتمرير المعلومات بين الشاشات من خلال استخدام قاعدة البيانات أو بلوك startValue!

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image31.png" alt="image31" width="597" height="108" />

لقد صممنا شاشتنا الثانية مع (two lables). واحد لعرض اسم العالمة وآخر لعرض الوصف الخاص بها. وأضفنا زر للرجوع"back" للعودة <strong>للشاشة 1</strong>. لا تنسيْ أنكِ تحتاجين أن تستخدمي <strong>TinyDB </strong>لهذه الشاشة!

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image56-1024x509.png" alt="image56" width="1024" height="509" />

بما أن القيمة الأولية(start value) هي اسم العالمة، نعرض القيمة الأولية في <strong>label1 </strong>وأيضا نستخدم القيمة الأولية لاسترداد الوصف الخاص بالعالمة من قاعدة البيانات لعرضه في <strong>label2</strong>. يمكنكِ أن تجدي بلوك <i>get start value</i>في ال <i>control</i> category

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image06.png" alt="image06" width="636" height="175" />

لا تنسِ برمجة زر الرجوع لإرجاعك للشاشة الأولى!

<img src="http://www.technovationchallenge.org/wp-content/uploads/2016/11/image11-1024x198.png" alt="image11" width="471" height="91" />

عندما يقوم المستخدم بالرجوع الى الخلف للشاشة 1 سوف تقوم ببدء التفيذ من البداية وكل شيء سوف يبدء التفيذ من البداية.
<h3>آخر نقطة بحث</h3>
تأكدي من أن كل ما في تطبيقك يعمل بشكل صحيح! هل اختيار شيء من ال ListView يأخذك الى Screen2 ويعرض ال tag name و ال database value؟

ما زلتِ عالقة؟ حمّلي الكود الخاص بنا هنا: <a href="http://appinventor.mit.edu/explore/ai2/share.html">تعليمات</a> حول تتزيل واستعمال الشيفرة المصدرية

<a href="https://drive.google.com/file/d/0B9HV58UviqU_YXU1eTBKMDN1ZVE/view" target="_blank">
تحميل الشيفرة المصدرية
</a>
